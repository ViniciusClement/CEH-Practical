Module 07: Malware Threats

Creating an HTTP Trojan and Remotely Controlling a Target Machine Using HTTP RAT
	In Windows 2016, run httprat.exe
	Uncheck send notification with ip address to mail. Set port 84 > Create
	In Windows 8, run created httpserver.exe (Check Task Manager for Httpserver (32bit))
	In Windows 2016, Open Windows 8 IP in browser. z0mbie's HTTP_RAT Page appears.

Creating a Trojan Server Using the GUI Trojan MoSucker
	In Windows 2012, run MoSucker CreateServer.exe, note the Connection-port
	Keylogger > Enable off-line keylogger
	Run MoSucker.exe, Fill IP and port of target.
	Share and run created server in target.

Gaining Control over a Victim Machine Using njRAT
	In Windows 10, Turn on Windows Defender Firewall (Use recommended settings)
	In Windows 2016, run njRAT v0.7d.exe. Set port & start.
	njRAT GUI > Builder > Host IP, Copy To StartUp and Registry StartUp > Build (Test.exe)
	Share Test.exe with Windows 10 & run.
	njRAT gets a persistent connection.
	
Obfuscating a Trojan Using SwayzCryptor and Making it Undetectable to Various Anti-Virus Programs
One method to bypass AVs is to “crypt” (an abbreviation of “encrypt”) the malicious files using fully undetectable crypters (FUDs). 
	Stay in previouse njRAT lab. In Windows 2016, run SwayzCryptor.exe
	File > Test.exe
	Start up, Mutex, and Disable UAC, and click Encrypt. Save as CryptedFile.exe
	Share CryptedFile.exe with Windows 2012 & run.
	njRAT gets a persistent connection.

Creating a Server Using the ProRat Tool
	In Windows 10, run ProRat.exe.
	Create > Create ProRat Server (342 Kbayt)
	Set Server Port, Password, Victim Name. Check all options under 'Invisibility'
	Bind with file > MyCar.jpg
	Server Extensions > EXE (Has icon support)
	Create Server
	Share binder_server.exe with Windows 2012 & run.
	In ProRat, enter IP of Windows 2012 > Connect. Enter password of binder_server.exe
	ProRat gets a remote connection.

Creating a Trojan Server Using Theef
	In Windows 2012, directly run trojan Server210.exe
	In Windows 10, run Client210.exe > Enter victim's IP > Connect
	Theef gets a remote connection.

Creating a Virus Using the JPS Virus Maker Tool
	In Windows 2012, run jps.exe
	Check options embedded in the virus file are Disable Yahoo, Disable Internet Explorer, Disable Norton Anti Virus, Disable McAfee Anti Virus, Disable Taskbar, Disable Security Center, Disable Control Panel, Hide Windows Clock, Hide All Tasks in Taskmgr, Change Explorer Caption, Destroy Taskbar, Destroy Offlines (Y!Messenger), Destroy Audio Service, Terminate Windows and Auto Startup.
	Check Restart. Name after Install: Rundll32, Server name: Svchost.exe
	Create Virus!
	Check Change XP Password, Change Computer Name, Change IE Home Page.
	Enable Convert to Worm. Name: fedevi, Time: 1s. / Icon: JPG
	Create Virus!
	Svchost.exe created. Pack this virus with a binder or virus packager & send to target.

Creating a Worm Using Internet Worm Maker Thing
	In Windows 2016, run Generator.exe
	Enter Worm name, author, version, message and output path. Check Compile To EXE Support
	Select Activate Payloads on Date, Chance of activating payloads: 5. Select Hide All Drives, Disable Task Manager, Disable keyboard, Disable Mouse, and Message Box.
	Enter Title and a Message, Icon: Information. Select Disable Regedit, Disable Explorer.exe and change Reg owner.
	Set Owner field, Change Reg Oragnisation & change Homepage.
	Select Disable Windows Security, Disable Norton Security, Uninstall Norton Script Blocking, Disable Macro Security, Disable Run command, Disable shutdown, Disable Logoff, Disable windows Updates, No Search Command, Swap Mouse Button, and Open Web Page.
	Select Change IE Title Bar, Change Win Media Player Txt, Open Cd Drives, Lock Workstation and Download File.
	Select Print Message, Disable System Restore, and Change NOD32 Text (enter respective texts.)
	Select Mute Speakers, Delete a Folder, Change Wallpaper, and CPU Monster. Select Change Time, and enter Hour and Min.
	Select Change Date check box, and enter DD, MM, and YY.
	Select Loop Sound, Hide Desktop, Disable Malware Remove, Disable Windows File Protection, Corrupt Antivirus, and Change Computer Name.
	Select Change Drive icon, Add To Context Menu, Change Clock Text, Keyboard Disco, and Add To Favorites.
	Select Exploit Windows Admin Lockout Bug and Blue Screen of Death.
	Select Infect Bat Files, under Infection Options; select Hide Virus Files, under Extras; and click Generate Worm, under Control Panel.
	worm.vbs is created.

Virus Analysis using IDA
	In Windows 2016, run idademo73_windows.exe
	New > Viruses\Klez Virus Live!\face.exe
	IDA Pro Analysis > View > Graphs > Flow Chart
	View > Graphs > Function Calls
	Windows > Hex View-1
	Windows > Structures

Virus Analysis Using OllyDbg
	In Windows 2016, run OLLYDBG.EXE
	Open \Viruses\tini.exe
	View > Log
	View > Executable module
	View > Memory
	View > Threads

Detecting Trojans
	In Windows 2016, run Tcpview.exe
	TCPView helps you analyze TCP and other ports.
	Run autoruns.exe, displays all the processes, dll’s, services, and so on.
	In Windows 10, run jv16 PowerTools, full user interface, Restart computer after done.
	Clean and Speedup My Computer, Check Registry Errors & fix by deleting.
	Main Tools > Control which programs start automatically

Monitoring TCP/IP Connections Using the CurrPorts
	In Windows 2016, run njRAT v0.7d.exe. Set port & start.
	njRAT GUI > Builder > Host IP, Copy To StartUp and Registry StartUp > Build (Test.exe)
	Share Test.exe with Windows 10 & run.
	In Windows 10, Run CurrPorts (cports.exe)
	Observe malicious process server.exe on port 5552
	Kill Processes Of Selected Ports OR Close Selected TCP Connections

Removing Malware using Clamwin
	Previous lab required.
	In Windows 10, install ClamWin (Uncheck Download virus database file)
	Memory Scan, Scan C:

Performing Registry Entry Monitoring
	In Windows 2016, Regshot-x64-Unicode.exe > Run as administrator
	Logs save as HTML document
	1st Shot > Shot and Save
	Install some application (e.g. HashTool)
	2nd shot > Shot and Save
	Compare

Startup Program Monitoring Tool
	In Windows 2016, install WinPatrol(Check Start the application)
	Startup Programs > Observe entries
	IE Helpers > Observe toolbars and links
	Services > Observe
	Files Types > Observe (Info > Expand Info)
	Active Tasks > Observe running tasks